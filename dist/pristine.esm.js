var y={en:{required:"This field is required",email:"This field requires a valid email address",number:"This field requires a number",integer:"This field requires an integer value",url:"This field requires a valid website URL",tel:"This field requires a valid telephone number",maxlength:"This fields length must be < ${1}",minlength:"This fields length must be > ${1}",min:"Minimum value for this field is ${1}",max:"Maximum value for this field is ${1}",filesize:"Maximum file size is ${1}",filesizetotal:"Maximum total file size ${1}",filetype:"Allowed file types: ${1.split(',').join(' ')}",pattern:"Please match the requested format",equals:"The two fields do not match",default:"Please enter a correct value"}};function I(n,a){for(;(n=n.parentElement)&&!n.classList.contains(a););return n}function T(n){return this.replace(/\${([^{}]*)}/g,(a,u)=>arguments[u])}function C(n){return n.pristine.self.form.querySelectorAll('input[name="'+n.getAttribute("name")+'"]:checked').length}function $(n,a){for(let u in a)u in n||(n[u]=a[u]);return n}var R={classTo:"form-group",errorClass:"has-danger",successClass:"has-success",errorTextParent:"form-group",errorTextTag:"div",errorTextClass:"text-help",disableSubmitUntilValid:!0,validateDefaultValues:!0,validationStrategy:"off"},_="pristine-error",G="input:not([type^=hidden]):not([type^=submit]), select, textarea",V=new Set(["required","min","max","minlength","maxlength","pattern"]),H=/^(([^<>()\[\]\\.,;:\s@']+(\.[^<>()\[\]\\.,;:\s@']+)*)|('.+'))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,z=/-message(?:-([a-z]{2}(?:_[A-Z]{2})?))?/,g="en",F={},m=function(n,a){a.name=n,a.priority===void 0&&(a.priority=1),F[n]=a};m("text",{fn:()=>!0,priority:0});m("required",{fn:function(n){return this.type==="radio"||this.type==="checkbox"?C(this):this.type==="file"?this.files&&this.files.length>0:n!==void 0&&n.trim()!==""},priority:99,halt:!0});m("email",{fn:n=>!n||H.test(n)});m("number",{fn:n=>!n||!isNaN(parseFloat(n)),priority:2});m("integer",{fn:n=>!n||/^\d+$/.test(n)});m("minlength",{fn:(n,a)=>!n||n.length>=parseInt(a)});m("maxlength",{fn:(n,a)=>!n||n.length<=parseInt(a)});m("min",{fn:function(n,a){return!n||(this.type==="checkbox"?C(this)>=parseInt(a):parseFloat(n)>=parseFloat(a))}});m("max",{fn:function(n,a){return!n||(this.type==="checkbox"?C(this)<=parseInt(a):parseFloat(n)<=parseFloat(a))}});m("pattern",{fn:(n,a)=>{let u=a.match(new RegExp("^/(.*?)/([gimy]*)$"));return!n||new RegExp(u[1],u[2]).test(n)}});m("equals",{fn:(n,a)=>{let u=document.querySelector(a);return u&&(!n&&!u.value||u.value===n)}});m("filesize",{fn:function(n,a){return!this.files||this.files.length===0?!0:Array.from(this.files).every(u=>u.size<=parseInt(a))}});m("filesizetotal",{fn:function(n,a){return!this.files||this.files.length===0?!0:Array.from(this.files).reduce((u,t)=>u+t.size,0)<=parseInt(a)}});m("filetype",{fn:function(n,a){if(!this.files||this.files.length===0)return!0;let u=a.split(",").map(t=>t.trim().toLowerCase());return Array.from(this.files).every(t=>u.includes(t.type.toLowerCase()))}});var q=class{constructor(a,u){let t=this;E(a,u);async function E(e,s){if(e.setAttribute("novalidate","true"),t.destroyed=!1,t.form=e,t.config=$(s||{},R),t.fields=Array.from(e.querySelectorAll(G)).map(function(r){let i=[],f={},c={},d=new Set,o=!1;[].forEach.call(r.attributes,function(l){if(/^data-pristine-/.test(l.name)){let p=l.name.substr(14);V.has(p)?d.add(p):p==="type"&&d.add(l.value)}}),[].forEach.call(r.attributes,function(l){if(/^data-pristine-/.test(l.name)){let p=l.name.substr(14),x=p.match(z);if(x!==null){let w=x[1]===void 0?"en":x[1];c.hasOwnProperty(w)||(c[w]={});let U=p.replace(z,"");c[w][U]=l.value;return}p==="type"&&(p=l.value),L(i,f,p,l.value)}else V.has(l.name)&&!d.has(l.name)?L(i,f,l.name,l.value):l.name==="type"&&!d.has(l.value)&&L(i,f,l.value)}),i.sort((l,p)=>p.priority-l.priority),t.config.validationStrategy==="live"?b(r,~["radio","checkbox","select"].indexOf(r.getAttribute("type"))?"change":"input",async function(l){await t.validate(l.target)}.bind(t)):t.config.validationStrategy==="blur"?b(r,~["radio","checkbox","select"].indexOf(r.getAttribute("type"))?"change":"blur",async function(l){await t.validate(l.target)}.bind(t)):t.config.validationStrategy==="hybrid"&&(b(r,~["radio","checkbox","select"].indexOf(r.getAttribute("type"))?"change":"blur",async function(l){o=!0,await t.validate(l.target)}.bind(t),{once:!0}),b(r,~["radio","checkbox","select"].indexOf(r.getAttribute("type"))?"change":"input",async function(l){o&&await t.validate(l.target)}.bind(t))),t.config.validateDefaultValues&&queueMicrotask(async function(){let l=r.type==="checkbox"||r.type==="radio"?r.checked!==r.defaultChecked:r.value!==r.defaultValue,p=r.value.trim()==="",x=r.hasAttribute("required")||r.hasAttribute("data-pristine-required")!==null;(l||x&&!p)&&(o=!0,await t.validate(r))});let h={input:r,validators:i,params:f,messages:c,touched:o,self:t};return r.pristine=h}.bind(t)),t.submit=t.form.querySelector("button[type=submit], input[type=submit]"),t.config.disableSubmitUntilValid){let r=function(){clearTimeout(t.debounceTimeout),t.debounceTimeout=setTimeout(A.bind(t),50)};t.debounceTimeout=null,b(t.form,"input",r.bind(t)),b(t.form,"change",r.bind(t)),queueMicrotask(A)}b(t.form,"reset",O.bind(t))}async function A(){if(!t.submit)return;let e=!await t.validate(!0),s=!1;if(t.config.validateDefaultValues)for(let r of t.fields){let i=r.input;if(s=i.type==="checkbox"||i.type==="radio"?i.checked!==i.checked:i.value!==i.defaultValue,s)break}t.submit.disabled=e||t.config.validateDefaultValues&&!s}function L(e,s,r,i){let f=F[r];if(f&&(e.push(f),i)){let c=r==="pattern"?[i]:i.split(",");c.unshift(null),s[r]=c}}t.validate=async function(e,s){s=e&&s===!0||e===!0;let r=t.fields;e!==!0&&e!==!1&&(e instanceof HTMLElement?r=[e.pristine]:(e instanceof NodeList||e instanceof(window.$||Array)||e instanceof Array)&&(r=Array.from(e).map(f=>f.pristine)));let i=!0;for(let f=0;r[f];f++){let c=r[f];await N(c)?!s&&D(c):(i=!1,!s&&k(c))}return i},t.getErrors=function(e){if(!e){let s=[];for(let r=0;r<t.fields.length;r++){let i=t.fields[r];i.errors.length&&s.push({input:i.input,errors:i.errors})}return s}return e.tagName&&e.tagName.toLowerCase()==="select"?e.pristine.errors:e.length?e[0].pristine.errors:e.pristine.errors};async function N(e){let s=[],r=!0,i=[];e.input.hasAttribute("multiple")?(e.input.type="select")?i.push(Array.from(selectElem.selectedOptions).map(f=>f.value)):i.push(e.input.split(",")):i.push(e.input.value);for(let f=0;f<i.length;f++){let c=i[f];for(let d=0;e.validators[d];d++){let o=e.validators[d],h=e.params[o.name]?e.params[o.name]:[];if(h[0]=c,(o.fn.constructor.name==="AsyncFunction"?!await o.fn.apply(e.input,h):!o.fn.apply(e.input,h))&&(r=!1,typeof o.msg=="function"?s.push(o.msg(c,h)):typeof o.msg=="string"?s.push(T.apply(o.msg,h)):o.msg===Object(o.msg)&&o.msg[g]?s.push(T.apply(o.msg[g],h)):e.messages[g]&&e.messages[g][o.name]?s.push(T.apply(e.messages[g][o.name],h)):y[g]&&y[g][o.name]?s.push(T.apply(y[g][o.name],h)):s.push(T.apply(y[g].default,h)),o.halt===!0))break}if(!r)break}return e.errors=s,r}t.addValidator=function(e,s,r,i,f){e instanceof HTMLElement?(e.pristine.validators.push({fn:s,msg:r,priority:i,halt:f}),e.pristine.validators.sort((c,d)=>d.priority-c.priority)):console.warn("The parameter elem must be a dom element")};function S(e){if(e.errorElements)return e.errorElements;let s=I(e.input,t.config.classTo),r=null,i=null;return t.config.classTo===t.config.errorTextParent?r=s:r=s.querySelector("."+t.config.errorTextParent),r&&(i=r.querySelector("."+_),i||(i=document.createElement(t.config.errorTextTag),i.className=_+" "+t.config.errorTextClass,r.appendChild(i),i.pristineDisplay=i.style.display)),e.errorElements=[s,i]}function k(e){let s=S(e),r=s[0],i=s[1],{input:f}=e,d=`error-${f.id||Math.floor(new Date().valueOf()*Math.random())}`;if(r){let o=v(t.config.errorClass),h=v(t.config.successClass);h.length&&h.forEach(l=>r.classList.remove(l)),o.length&&o.forEach(l=>r.classList.add(l)),f.setAttribute("aria-describedby",d),f.setAttribute("aria-invalid","true")}i&&(i.setAttribute("id",d),i.setAttribute("role","alert"),i.innerHTML=e.errors.join("<br/>"),i.style.display=i.pristineDisplay||"")}t.addError=function(e,s){e=e.length?e[0]:e,e.pristine.errors.push(s),k(e.pristine)};function P(e){let s=S(e),r=s[0],i=s[1],{input:f}=e;if(r){let c=v(t.config.errorClass),d=v(t.config.successClass);c.length&&c.forEach(o=>r.classList.remove(o)),d.length&&d.forEach(o=>r.classList.remove(o)),f.removeAttribute("aria-describedby"),f.removeAttribute("aria-invalid")}return i&&(i.removeAttribute("id"),i.removeAttribute("role"),i.innerHTML="",i.style.display="none"),s}function D(e){let s=P(e)[0],r=v(t.config.successClass);r.length&&s&&r.forEach(i=>s.classList.add(i))}function b(e,s,r){e.addEventListener(s,r),e.__pristineListeners||(e.__pristineListeners=[]),e.__pristineListeners.push({event:s,handler:r})}function M(e){if(e.__pristineListeners){for(let{event:s,handler:r}of e.__pristineListeners)e.removeEventListener(s,r);e.__pristineListeners=[]}}async function O(){for(let e=0;t.fields[e];e++)t.fields[e].errorElements=null,t.fields[e].touched=!1;t.config.disableSubmitUntilValid&&await A.bind(t),Array.from(t.form.querySelectorAll("."+_)).map(function(e){e.parentNode.removeChild(e)}),Array.from(t.form.querySelectorAll("."+t.config.classTo)).map(function(e){let s=v(t.config.errorClass),r=v(t.config.successClass);s.length&&r.forEach(i=>e.classList.remove(i)),s.length&&s.forEach(i=>e.classList.remove(i))})}t.reset=O.bind(t);function v(e){let s=e.split(" ").filter(r=>r);return s.length?s:[]}return t.destroy=async function(){t.destroyed||(t.destroyed=!0,t.debounceTimeout&&(clearTimeout(t.debounceTimeout),t.debounceTimeout=null),await t.reset(),t.fields.forEach(function(e){M(e.input),delete e.input.pristine}),t.fields=[],M(t.form))},t.setGlobalConfig=function(e){R=e},t}static addValidator(a,u,t,E,A){m(a,{fn:u,msg:t,priority:E,halt:A})}static addMessages(a,u){let t=y.hasOwnProperty(a)?y[a]:y[a]={};Object.keys(u).forEach(function(E,A){t[E]=u[E]})}static setLocale(a){g=a}};export{q as default};
//# sourceMappingURL=pristine.esm.js.map
